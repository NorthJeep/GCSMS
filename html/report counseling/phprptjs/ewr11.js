/**
 * JavaScript for PHP Report Maker 11
 * @license (C) 2007-2018 e.World Technology Ltd.
 */
var ewrReportUrlDialog,ewrEmailDialog,ewrExportDialog,ewrPopups={},$rowindex$=null;var ewrModalLookupDialog;var ewrDrillCharts=[],ewrExporting=false,ewrExportCharts=[],ewrDrillDownCharts=[];var EWR_TABLE_CLASSNAME="ewTable";var EWR_GRID_CLASSNAME="ewGrid";var EWR_TABLE_ROW_CLASSNAME="ewTableRow";var EWR_TABLE_ALT_ROW_CLASSNAME="ewTableAltRow";var EWR_ITEM_TEMPLATE_CLASSNAME="ewTemplate";var EWR_ITEM_TABLE_CLASSNAME="ewItemTable";var EWR_TABLE_LAST_ROW_CLASSNAME="ewTableLastRow";var EWR_TABLE_LAST_COL_CLASSNAME="ewTableLastCol";var EWR_TABLE_BORDER_BOTTOM_CLASSNAME="ewTableBorderBottom";var EWR_UNFORMAT_YEAR=50;var EWR_LOOKUP_DELAY=250;var EWR_POPUP_MINWIDTH=200;var EWR_POPUP_MINHEIGHT=150;var EWR_POPUP_DEFAULTHEIGHT=200;var EWR_EMPTY_VALUE="##empty##";var EWR_NULL_VALUE="##null##";var EWR_SHOW_EXPORT_DIALOG=true;var EWR_IS_SCREEN_SM_MIN=window.matchMedia&&window.matchMedia("(min-width: 768px)").matches||!window.matchMedia&&jQuery(window).width()>=768;var ewr_ClientScriptInclude=jQuery.getScript;var ewrLightboxSettings={transition:"none",photo:true,opacity:.5};var ewrAutoSuggestSettings={highlight:true,hint:true,minLength:1,limit:EWR_AUTO_SUGGEST_MAX_ENTRIES,trigger:"click",delay:0,templates:{footer:'<div class="tt-footer"><a href="#" class="tt-more"></a></div>'}};if(!EWR_RESET_HEIGHT){jQuery(document).on("overflow",function(e,t){if(EWR_IS_SCREEN_SM_MIN)jQuery("body, .wrapper").css("overflow-x","auto")})}var ewrForms={};function ewr_InitIcons(){var e=jQuery;e(".ewIcon, .ewTableHeaderPopup .icon-filter").closest("a, button").add(".ewDrillLink, .ewTooltip").tooltip({container:"body",trigger:EWR_IS_MOBILE?"manual":"hover",placement:"bottom"})}function ewr_SetSessionTimer(){var e=jQuery,t,r,a,n,i,o=e("#ewrTimer"),s=(EWR_SESSION_KEEP_ALIVE_INTERVAL>0||EWR_IS_LOGGEDIN&&EWR_IS_AUTOLOGIN)&&EWR_SESSION_URL;var l=function(){var t=EWR_SESSION_URL+"?rnd="+ewr_Random();e.get(t,function(t){EWR_TOKEN=t;e("input:hidden[name=token]").val(t)})};o.find(".modal-footer .btn-primary").click(function(e){if(a)a.cancel();o.modal("hide");l();if(!s&&EWR_SESSION_TIMEOUT>0)c()});var u=function(){i=EWR_SESSION_TIMEOUT_COUNTDOWN;t=EWR_SESSION_TIMEOUT-EWR_SESSION_TIMEOUT_COUNTDOWN;if(t<0){t=0;i=EWR_SESSION_TIMEOUT}if(a)a.cancel();if(r)r.cancel()};var d=function(){if(n)n.cancel();a=e.later(1e3,null,function(){if(i>0){o.find(".modal-body").html('<p class="text-danger">'+ewLanguage.Phrase("SessionWillExpire").replace("%s",i)+"</p>");o.modal("show")}else{o.find(".modal-body").html('<p class="text-danger">'+ewLanguage.Phrase("SessionExpired")+"</p>");u();e.later(1e3,null,function(){o.modal("hide");window.location=EWR_TIMEOUT_URL+"?expired=1"})}i--},null,true)};var c=function(){u();r=e.later(t*1e3,null,d)};if(s){var f=EWR_SESSION_KEEP_ALIVE_INTERVAL>0?EWR_SESSION_KEEP_ALIVE_INTERVAL:EWR_SESSION_TIMEOUT-EWR_SESSION_TIMEOUT_COUNTDOWN;if(f<=0)f=60;n=e.later(f*1e3,null,l,null,true)}else{if(EWR_SESSION_TIMEOUT>0)c()}}function ewr_InitExportLinks(e){var t=jQuery,r=e&&e.target?e.target:document;t(r).find(".ewrExportLink[href]:not(.ewEmail):not(.ewPrint):not(.ewXml)").click(function(e){var r,a=t(this),n=a.attr("href");if(n&&!n.startsWith("javascript:"))ewr_FileDownload(n);e.preventDefault()})}function ewr_FileDownload(e,t){var r=window.location!=window.parent.location&&window.parent.jQuery?window.parent.jQuery:jQuery;r("body").css("cursor","wait");if(EWR_SHOW_EXPORT_DIALOG){$dlg=r("#ewMsgBox").length?r("#ewMsgBox"):r("#ewrMsgBox");$dlg.find(".modal-body").html("<p>"+ewLanguage.Phrase("Exporting")+"</p>");$dlg.find(".modal-footer button").prop("disabled",true);$dlg.modal("show")}var a=t?"POST":"GET";r.fileDownload(e,{httpMethod:a,data:t||null,successCallback:function(e){if(EWR_SHOW_EXPORT_DIALOG)$dlg.modal("hide");r(document).trigger("export",[{type:"done",url:e}])},failCallback:function(e,t){if(EWR_SHOW_EXPORT_DIALOG)$dlg.find(".modal-body").html("<div class='text-danger'><h4>"+ewLanguage.Phrase("FailedToExport")+"</h4>"+e+"</div>");r(document).trigger("export",[{type:"fail",url:t}])}}).always(function(){if(EWR_SHOW_EXPORT_DIALOG)$dlg.find(".modal-footer button").prop("disabled",false);r("body").css("cursor","default");r(document).trigger("export",[{type:"always",url:e}])})}jQuery(function(e){e("div.ewTableHeaderBtn").each(function(){var t=e(this),r=0;t.find(".ewTableHeaderSort:has(.caret), .ewTableHeaderPopup").each(function(){r+=e(this).width()});if(r)t.css(EWR_CSS_FLIP?"padding-left":"padding-right",r+4)});ewr_InitIcons();ewr_SetSessionTimer();ewr_InitExportLinks();if(e(".ewTableHeaderPopup").length||e(".ewDrillLink").length||ewrDrillDownCharts.length)e("html").css({height:"auto"});e.extend(ewrLightboxSettings,{title:ewLanguage.Phrase("LightboxTitle"),current:ewLanguage.Phrase("LightboxCurrent"),previous:ewLanguage.Phrase("LightboxPrevious"),next:ewLanguage.Phrase("LightboxNext"),close:ewLanguage.Phrase("LightboxClose"),xhrError:ewLanguage.Phrase("LightboxXhrError"),imgError:ewLanguage.Phrase("LightboxImgError")});e(".ewLightbox").each(function(){var t=e(this);if(t.colorbox)t.colorbox(e.extend({rel:t.data("rel")},ewrLightboxSettings))});e("table."+EWR_TABLE_CLASSNAME).each(ewr_SetupTable);e("table."+EWR_GRID_CLASSNAME).each(ewr_SetupGrid);e("input[name=pageno]").keypress(function(e){if(e.which==13){var t=window.location.href,r=t.lastIndexOf(window.location.search);window.location=t.substr(0,r)+"?"+this.name+"="+parseInt(this.value);return false}});e("input[data-calendar]").each(ewr_CreateDateTimePicker);if((typeof EW_USE_JAVASCRIPT_MESSAGE=="undefined"||!EW_USE_JAVASCRIPT_MESSAGE)&&EWR_USE_JAVASCRIPT_MESSAGE)ewr_ShowMessage();if(!EWR_IS_SCREEN_SM_MIN){e(".table-responsive [data-toggle='dropdown']").parent().on("shown.bs.dropdown",function(){var t=e(this),r=t.find(".dropdown-menu"),a=t.closest(".table-responsive")[0];if(a.scrollHeight-a.clientHeight){var n=r.offset().top+r.outerHeight()-e(a).offset().top-a.clientHeight;if(n>0)r.css(EWR_CSS_FLIP?"right":"left","100%").css("top",parseFloat(r.css("top"))-n)}})}e(".box").on("collapsed.boxwidget",function(){var t=e(this),r=t.closest("[class^='col-']");if(r.css("min-height"))r.data("min-height",r.css("min-height"));r.css("min-height",0)});e(".box").on("expanded.boxwidget",function(){var t=e(this),r=t.closest("[class^='col-']");if(r.data("min-height"))r.css("min-height",r.data("min-height"))})});jQuery(document).on("show.bs.modal",".modal",function(){var e=jQuery,t=1050+10*e(".modal:visible").length;e(this).css("z-index",t);setTimeout(function(){e(".modal-backdrop").not(".modal-stack").css("z-index",t-1).addClass("modal-stack")},0)});jQuery(document).on("hidden.bs.modal",".modal",function(){var e=jQuery;e(".modal:visible").length&&e(document.body).addClass("modal-open")});function ewr_ExportCharts(e,t,r,a){if(ewrExporting)return;r+="_"+(new Date).getTime();t+=(t.split("?").length>1?"&":"?")+"exportid="+r;var n=jQuery,i=n(e),o=a?"post":"get";if(i.is(".dropdown-menu a"))i=i.closest(".btn-group");function s(){if(a&&!/&(amp;)?custom=1/.test(t)){data=n(a).serialize();data+="&token="+EWR_TOKEN;n.post(t,data,function(e){ewr_ShowMessage(e)})}else{if(/export=(word|excel|pdf|email)&(amp;)?custom=1/.test(t)){if(/export=email/.test(t)){t=t.replace(/export=email&(amp;)?/i,"");t+="&"+n(a).serialize()}n("iframe.ewExport").remove();n("<iframe>").attr("src",t).addClass("ewExport").hide().appendTo(n("body").css("cursor","wait"));n.later(5e3,null,function(){n("body").css("cursor","default")})}else if(/export=print/.test(t)){ewr_Redirect(t,a,o)}else{ewr_FileDownload(t,null)}}}if(ewrExportCharts.length==0)return s();var l=0;function u(e){if(n.isObject(e)&&e.chart){var t=e.id,a=e.chart,i="div_"+t.substr(6);if(a.getImageURI){var o={chart_engine:"google",stream_type:"base64",stream:a.getImageURI(),token:EWR_TOKEN,parameters:"exportfilename="+r+"_"+t+".png|exportformat=png|exportaction=download|exportparameters=undefined"}}else{var d=n("#"+i).find("svg").parent().html();var o={chart_engine:"google",stream_type:"svg",stream:d,token:EWR_TOKEN,parameters:"exportfilename="+r+"_"+t+".png|exportformat=png|exportaction=download|exportparameters=undefined"}}n.ajax({url:EWR_CHART_EXPORT_HANDLER,data:o,cache:false,type:"POST",success:function(){l++;if(l==ewrExportCharts.length){s();ewrExporting=false;n("body").css("cursor","default")}else{u(ewrExportCharts[l])}}}).fail(function(e,t,r){ewrExporting=false;n("body").css("cursor","default");ewr_Alert(r+": "+e.responseText)})}else if(n.isString(e)){var t=e;var a=FusionCharts(t),c="cht_"+t.substr(6),i="div_export_"+t.substr(6),f=n("#"+i+" svg");a.getSVGString(function(e){var a={chart_engine:"fusioncharts",stream_type:"svg",stream:e,token:EWR_TOKEN,meta_bgColor:"#ffffff",meta_bgAlpha:"1",meta_DOMId:t,meta_width:f.attr("width"),meta_height:f.attr("height"),parameters:"exportfilename="+r+"_"+t+".png|exportformat=png|exportaction=download|exportparameters=undefined"};n.ajax({url:EWR_CHART_EXPORT_HANDLER,data:a,cache:false,type:"POST",success:function(){l++;if(l==ewrExportCharts.length){s();ewrExporting=false;n("body").css("cursor","default")}else{u(ewrExportCharts[l])}}}).fail(function(e,t,r){ewrExporting=false;n("body").css("cursor","default");ewr_Alert(r+": "+e.responseText)})})}}ewrExporting=true;n("body").css("cursor","wait");u(ewrExportCharts[0])}function ewr_CreatePopup(e,t){ewrPopups[e]=t}function ewr_ShowPopup(e,t){ewr_StopPropagation(e);var r=jQuery,a=r(this).tooltip("hide"),n=t.name,i=t.range,o=t.from,s=t.to,l=t.url||window.location.href.split("?")[0].split("#")[0];var u=function(){var e=a.data("bs.popover").tip(),t=e.find("form")[0];var i=r('<button type="button" class="btn btn-primary btn-sm ewPopupBtn">'+ewLanguage.Phrase("MessageOK")+"</button>").click(function(){if(t&&!ewr_SelectedEntry(t,n)){ewr_Alert(ewLanguage.Phrase("PopupNoValue"))}else{if(t)t.submit();a.popover("hide")}});e.find(".modal-footer").append(i).show()};var d=function(){var e=a.data("bs.popover").tip(),t=e.find("form")[0];var n=r('<button type="button" class="btn btn-default btn-sm ewPopupBtn">'+ewLanguage.Phrase("Cancel")+"</button>").click(function(){a.popover("hide")});e.find(".modal-footer").append(n)};if(!a.data("bs.popover")){a.popover({html:true,placement:"bottom",trigger:"manual",template:'<div class="popover">'+'<div class="popover-content" style="overflow: auto;"></div><div class="modal-footer" style="display: none;"></div></div>',content:'<div class="ewrLoading"><div class="ewSpinner"><div></div></div> '+ewLanguage.Phrase("Loading").replace("%s","")+"</div>",container:r("#ewrPopupFilterDialog")}).on("shown.bs.popover",function(e){if(ewrPopups[n]){ewr_SetPopupContent.call(a[0],n,ewrPopups[n],i,o,s);u();d()}else{r.ajax({cache:false,dataType:"json",data:"popup="+n,url:l,success:function(e){var t=a.data("args");ewr_CreatePopup(t.popupname,e);ewr_SetPopupContent.call(a[0],t.popupname,e,t.useRange,t.rangeFrom,t.rangeTo);u();d()},error:function(e){if(e.responseText){var t=a.data("bs.popover").tip();t.find(".popover-content").empty().append('<p class="text-error">'+e.responseText+"</p>");t.find(".modal-footer").empty();u()}}})}})}a.data("args",{popupname:n,useRange:i,rangeFrom:o,rangeTo:s}).popover("show")}function ewr_SetPopupContent(e,t,r,a,n){var i=jQuery,o=0,s=i(this);i.map(t,function(e){if(e["s"]===false)o++});var l=o==0,u=false,d=l?" checked":"";var c=i('<form id="'+e+'_FilterForm" class="form-horizontal" method="post">'+'<input type="hidden" name="token" value="'+EWR_TOKEN+'">'+'<input type="hidden" name="popup" value="'+e+'">'+'<div class="ewPopupContainer"></div></form>');var f=c.find("div");if(r){f.append('<div class="ewPopupItem"><table class="ewPopupRange">'+"<tr><td>"+ewLanguage.Phrase("PopupFrom")+"</td><td>"+'<select class="form-control" name="rf_'+e+'" style="width: auto;" onchange="ewr_SelectRange(this, \''+e+"');\">"+"</select></td></tr>"+"<tr><td>"+ewLanguage.Phrase("PopupTo")+"</td><td>"+'<select class="form-control" name="rt_'+e+'" style="width: auto;" onchange="ewr_SelectRange(this, \''+e+"');\">"+"</select></td></tr></table></div>");var p=f.find("select").first();p.append('<option value="">'+ewLanguage.Phrase("PopupSelect")+"</option>");i.map(t,function(e){var t=e["k"],r=e["v"];if(!t.startsWith("@@")&&t!=EWR_NULL_VALUE&&t!=EWR_EMPTY_VALUE){var n=t==a?" selected":"";p.append('<option value="'+t+'"'+n+">"+r+"</option>")}});var p=f.find("select").last();p.append('<option value="">'+ewLanguage.Phrase("PopupSelect")+"</option>");i.map(t,function(e){var t=e["k"],r=e["v"];if(!t.startsWith("@@")&&t!=EWR_NULL_VALUE&&t!=EWR_EMPTY_VALUE){selected=t==n?" selected":"";p.append('<option value="'+t+'"'+selected+">"+r+"</option>")}});f.append('<div class="ewPopupDivider"></div>')}f.append('<div class="ewPopupItem checkbox"><label><input type="checkbox" name="sel_'+e+'[]" value="" onclick="ewr_SelectAll(this);"'+d+">"+ewLanguage.Phrase("PopupAll")+"</label></div>");i.map(t,function(t){var r=t["k"],a=t["v"],n=t["s"]?" checked":"";if(r.startsWith("@@")){u=true}else if(u){u=false;f.append('<div class="ewPopupDivider"></div>')}f.append('<div class="ewPopupItem checkbox"><label><input type="checkbox" name="sel_'+e+'[]" value="'+r+'" onclick="ewr_UpdateSelectAll(this);"'+n+">"+a+"</label></div>")});var h=s.data("bs.popover").tip();h.find(".popover-content").empty().append(c);h.find(".modal-footer").empty()}function ewr_SelectedEntry(e,t){var r=jQuery,a=r(e.elements["sel_"+t+"[]"]);return a.length>0?a.filter(":not(:first):checked").length>0:a.prop("checked")}function ewr_SelectAll(e){ewr_ClearRange(e);jQuery(e.form.elements).filter("input:checkbox[name='"+e.name+"']:not(:first)").prop("checked",e.checked)}function ewr_UpdateSelectAll(e){ewr_ClearRange(e);var t=e.form;if(t)t.elements[e.name][0].checked=jQuery(e.form.elements).filter("input:checkbox[name='"+e.name+"']:not(:first):not(:checked)").length==0}function ewr_SelectRange(e){var t,r,a=e.form,n=e.name.replace(/^r[ft]_/,"");if(a.elements["rf_"+n].selectedIndex>-1)t=a.elements["rf_"+n].options[a.elements["rf_"+n].selectedIndex].value;if(a.elements["rt_"+n].selectedIndex>-1)r=a.elements["rt_"+n].options[a.elements["rt_"+n].selectedIndex].value;if(!$.isValue(t)||!$.isValue(r)||t===""||r==="")return;ewr_SetRange(e,t,r,true)}function ewr_ClearRange(e){var t=e.form,r=e.name.replace(/^sel__/,"").replace(/\[\]$/,"");var a=t.elements["rf_"+r],n=t.elements["rt_"+r];if(a&&n&&a.selectedIndex>0&&n.selectedIndex>0){a.selectedIndex=0;n.selectedIndex=0;ewr_SetRange(e,a.options[a.selectedIndex].value,n.options[n.selectedIndex].value,false)}}function ewr_SetRange(e,t,r,a){var n=jQuery,i=e.form,o=e.name.replace(/^r[ft]_/,"sel_")+"[]",s;n(i.elements).filter("input:checkbox[name='"+o+"']").each(function(){if(this.value==t)s=true;if(s)this.checked=a;else if(a)this.checked=false;if(this.value==r)s=false})}function ewr_Page(e){this.Name=e;this.PageID="";this.ValidateRequired=true}var ewrForms=function(e){if(e){var t=jQuery,r;if(t.isString(e)){r=e}else{r=t(ewr_GetForm(e)).attr("id")}if(r){for(var a in this){if(a===r)return this[a]}}}return undefined};function ewr_Form(e){var t=jQuery;this.ID=e;this.$Element=null;this.Form=null;this.InitSearchPanel=false;this.SrchOprChanged=function(e){var r=this.GetForm(),a=t(r),n=t.isString(e)?r.elements[e]:e;if(!n)return;var i=/^so2_/.test(n.id)?n.id.substr(4):n.id.substr(3),o=t(n).val(),s=o=="BETWEEN",l=o=="IS NULL"||o=="IS NOT NULL";if(/^so_/.test(n.id))a.find("[name^=sv_"+i+"],[name^=cal_sv_"+i+"]").prop("disabled",l);if(/^so2_/.test(n.id))a.find("[name^=sv2_"+i+"],[name^=cal_sv2_"+i+"]").prop("disabled",l);a.find("span.btw0_"+i).toggle(!s).end().find("span.btw1_"+i).toggle(s).find(":input").prop("disabled",!s)};this.ValidateRequired=true;this.Validate=null;this.DisableForm=function(){if(!EWR_DISABLE_BUTTON_ON_SUBMIT)return;var e=this.GetForm();t(e).find(":submit, :reset").prop("disabled",true).addClass("disabled")};this.EnableForm=function(){if(!EWR_DISABLE_BUTTON_ON_SUBMIT)return;var e=this.GetForm();t(e).find(":submit, :reset").prop("disabled",false).removeClass("disabled")};this.PreSubmit=function(){var e=this.GetForm(),r=t(e);r.find("input[name^=s_],input[name^=sx_],input[name^=q_]").prop("disabled",true);r.find("input[name$='[]'][data-multiple='1']").each(function(){var e=t(this),a=e.attr("id"),n=e.val().split(",");t.each(n,function(t,n){e.clone().attr("id",a+t).val(n).appendTo(r)})}).remove()};this.Submit=function(e){var r=this.GetForm(),a=t(r);this.DisableForm();if(!this.Validate||this.Validate()){if(e)r.action=e;this.PreSubmit();r.submit()}else{this.EnableForm()}return false};this.EmptyRow=null;this.MultiPage=null;this.Lists=function(e){return this.Lists[e]};this.CompileTemplates=function(){for(var e in this.Lists){var r=this.Lists[e];if(r.Template&&t.isString(r.Template))r.Template=t.templates(r.Template)}};this.AutoSuggests={};this.GetForm=function(){if(!this.Form){this.$Element=t("#"+this.ID);if(this.$Element.is("form")){this.Form=this.$Element[0]}else if(this.$Element.is("div")){this.Form=this.$Element.closest("form")[0]}}return this.Form};this.GetElement=function(e){if(!this.$Element)this.$Element=t("#"+this.ID);return e?ewr_GetElement(e,this.$Element):this.$Element[0]};this.GetElements=function(e){if(!this.$Element)this.$Element=t("#"+this.ID);var r="[name='"+e+"']";r="input"+r+",select"+r+",textarea"+r+",button"+r;var a=this.$Element.find(r);return a.length==0?null:a.length==1&&a.is(":not(:checkbox):not(:radio)")?a[0]:a.get()};this.PostAutoSuggest=function(){for(var e in this.AutoSuggests){var t=this.AutoSuggests[e].$input;if(t&&t.is(":focus")){t.blur();break}}};this.UpdateOpts=function(e){if(e===$rowindex$)return;var r=[],a=this.GetForm();this.CompileTemplates();for(var n in this.Lists){var i=this.Lists[n].ParentFields.slice();var o=this.Lists[n].Ajax;if(t.isValue(e)){n=n.replace(/^x_/,"x"+e+"_");for(var s=0,l=i.length;s<l;s++)i[s]=i[s].replace(/^x_/,"x"+e+"_")}if(t.isBoolean(o)){var u=[];for(var s=0,l=i.length;s<l;s++)u[u.length]=ewr_GetOptValues(i[s],a);r[r.length]=[n,u,o,false]}else{ewr_UpdateOpt.call(this,n,i,null,false)}}for(var s=0,d=r.length;s<d;s++)ewr_UpdateOpt.apply(this,r[s])};this.CreateAutoSuggest=function(e){var r=this,a=e.id;e.form=this;t(function(){var n=t.extend({},ewrAutoSuggestSettings,e);var i=a.replace(/^[xy](\d*|\$rowindex\$)_/,"x_");var o=r.AutoSuggests[i];if(t.isObject(o)&&!(o instanceof ewr_AutoSuggest))n=t.extend(n,o);r.AutoSuggests[a]=new ewr_AutoSuggest(n)})};this.OnError=function(e,t){return ewr_OnError(this,e,t)};this.GetFormData=function(){var e=this.GetForm(),r=t(e);if(ewr_HasFormData(e)){this.PreSubmit();return r.serialize()}return""};this.SetupFilters=function(e,r){var a=this.ID,n=this.FilterList,i=t(".ewSaveFilter[data-form="+a+"]"),o=t(".ewDeleteFilter[data-form="+a+"]"),s=o.parent("li").toggleClass("dropdown-submenu",!!r.length).toggleClass("disabled",!r.length),l=i.parent("li").toggleClass("disabled",!n),u=t(e.target);l.off("click.ew").on("click.ew",function(e){if(l.hasClass("disabled"))return false;ewr_Prompt(ewLanguage.Phrase("EnterFilterName"),function(e){r[r.length]=[e,n];t.localStorage.set(a+"_filters",r)},true);return false}).prevAll().remove();o.next("ul.dropdown-menu").remove();if(r.length){$menu=o.closest("ul.dropdown-menu");$submenu=t("<ul class='dropdown-menu'></ul>");for(var d in r){if(!t.isArray(r[d]))continue;t("<li><a data-index='"+d+"' href='#'>"+r[d][0]+"</a></li>").on("click",function(e){var n=t(this).find("a[data-index]").data("index");ewr_Prompt(ewLanguage.Phrase("DeleteFilterConfirm").replace("%s",r[n][0]),function(){delete r[n];t.localStorage.set(a+"_filters",r)});return false}).appendTo($submenu);t("<li><a class='ewFilterList' data-index='"+d+"' href='#'>"+r[d][0]+"</a></li>").insertBefore(l).on("click",function(e){var a=t(this).find("a[data-index]").data("index");t("<form>").attr({method:"post",action:location.href.split("?")[0]}).append(t("<input type='hidden'>").attr({name:"cmd",value:"resetfilter"}),t("<input type='hidden'>").attr({name:"token",value:EWR_TOKEN}),t("<input type='hidden'>").attr({name:"filter",value:JSON.stringify(r[a][1])})).appendTo("body").submit();return false})}t("<li class='divider'></li>").insertBefore(l);s.append($submenu)}};this.Init=function(){var e=this,r=this.GetForm(),a=t(r);if(window.localStorage){t(".ewFilterOption."+this.ID+" .ewButtonDropdown").on("show.bs.dropdown",function(r){var a=t.localStorage.get(e.ID+"_filters")||[];var n=t.grep(a,function(e){if(t.isArray(e)&&e.length==2)return e});e.SetupFilters(r,n)})}else t(".ewFilterOption").hide();if(!r)return;this.CompileTemplates();if(this.InitSearchPanel&&!ewr_HasFormData(r))t("#"+this.ID+"_SearchPanel").removeClass("in");t(".ewSearchToggle[data-form="+this.ID+"]").on("click.bs.button",function(){t("#"+t(this).data("form")+"_SearchPanel").collapse("toggle")});a.find("select[id^=so_]").each(function(){var e=t(this).change();if(e.val()!="BETWEEN")a.find("#so2_"+this.id.substr(2)).change()});this.UpdateOpts();if(this.$Element.is("form")){a.submit(function(t){return e.Submit()})}this.$Element.data("form",this)};ewrForms[this.ID]=this}function ewr_Prompt(e,t,r){var a=jQuery,n=a("#ewrPrompt"),i=n.find(".modal-body").empty();if(r){i.append('<div class="form-group">'+'<label class="control-label">'+e+"</label>"+'<input type="text" class="form-control" style="display: block; width: 100%;"></div>');$input=i.find("input").click(function(){$input.parent().removeClass("has-error")});n.find(".modal-footer .btn-primary").unbind().click(function(e){var r=a.trim($input.val());if(r==""){$input.parent().addClass("has-error");$input[0].focus()}else{n.modal("hide");if(a.isFunction(t))t(r)}});n.on("shown.bs.modal",function(e){$input[0].focus()})}else{i.append("<div>"+e+"</div>");n.find(".modal-footer .btn-primary").unbind().click(function(e){n.modal("hide");if(a.isFunction(t))t()})}n.modal("show")}function ewr_GetForm(e){var t=jQuery,r=t(e),a=r.closest(".ewForm");if(!a[0])a=r.closest(".ewGrid").find(".ewForm");return a[0]}function ewr_HasFormData(e){var t=jQuery,r=t(e).find("[name^=sv_][value!=''][value!='{value}'],[name^=sv2_][value!=''][value!='{value}']").get();for(var a=0,n=r.length;a<n;a++){var i=r[a];if(/^(so|so2)_/.test(i.name)){if(/^IS/.test(t(i).val()))return true}else if(i.type=="checkbox"||i.type=="radio"){if(i.checked)return true}else if(i.type=="select-one"||i.type=="select-multiple"){for(var o=0,s=i.options.length;o<s;o++){if(i.options[o].selected&&i.options[o].value!=""&&i.options[o].value!="##all##")return true}}else if(i.type=="text"||i.type=="hidden"||i.type=="textarea"){return true}}return false}function ewr_UpdateOpt(e,t,r,a){var n=jQuery,i=this,o=n(this);var s=function(){o.dequeue()};if(!e||e.length==0)return s();var l=this.Form?this.Form:this.form?this.form:null;if(this.form&&/^x\d+_/.test(this.id))l=ewr_GetForm(this);if(!l)return s();var u=this.Form?this:ewrForms[l.id];if(!u)return s();var d=n.makeArray(arguments);if(this.form&&n.isArray(e)&&n.isString(e[0])){for(var c=0,f=e.length;c<f;c++)o.queue(n.proxy(ewr_UpdateOpt,i,e[c],t,r,a));var p=u.Lists[this.id.replace(/^[xy]\d*_/,"x_")];return s()}if(n.isString(e))e=ewr_GetElements(e,l);var h=ewr_GetOptValues(e);var g=ewr_GetId(e,false);if(!g)return s();var m=g.replace(/^([xy])(\d*)_/,"x_");var v=RegExp.$1;var w=RegExp.$2;var _=[];if(n.isUndefined(t)){t=u.Lists[m].ParentFields.slice();if(w!=""){for(var c=0,f=t.length;c<f;c++)t[c]=t[c].replace(/^x_/,"x"+w+"_")}else if(v=="y"){}}if(n.isArray(t)&&t.length>0){if(n.isArray(t[0])){_=t}else if(n.isString(t[0])){for(var c=0,f=t.length;c<f;c++)_[_.length]=ewr_GetOptValues(t[c],l)}}if(!ewr_IsAutoSuggest(e))ewr_ClearOpt(e);var E=function(t){for(var r=0,i=t.length;r<i;r++){var o={data:t[r],parents:_,valid:true,name:ewr_GetId(e),form:l};n(document).trigger("addoption",[o]);if(o.valid)ewr_NewOpt(e,t[r],l)}if(!e.options&&e.length){ewr_RenderOpt(e);e=ewr_GetElements(g,l)}ewr_SelectOpt(e,h);if(a!==false)n(e).first().change()};if(n.isUndefined(r))r=u.Lists[m].Ajax;if(!n.isBoolean(r)||n.isArray(u.Lists[m].Options)&&u.Lists[m].Options.length>0){var b=u.Lists[m].Options;E(b);if(/s(ea)?rch$/.test(l.id)&&v=="x"){d[0]=g.replace(/^x_/,"y_");ewr_UpdateOpt.apply(this,d)}return s()}else{var S=ewr_GetId(e),y=n(l).find("#s_"+S).val();if(!y)return s();y+="&type=updateopt&name="+S;if(ewr_IsAutoSuggest(e)&&this.Form||ewr_IsModalLookup(e))y+="&v0="+(h[0]?encodeURIComponent(h[0]):ewr_Random());for(var c=0,R=_.length;c<R;c++)y+="&v"+(c+1)+"="+encodeURIComponent(_[c].join(EWR_LOOKUP_FILTER_VALUE_SEPARATOR));y+="&token="+EWR_TOKEN;n.ajax(EWR_LOOKUP_FILE_NAME,{type:"POST",dataType:"json",data:y,async:r,cache:false,success:function(e){E(e||[])}}).always(function(){s()});if(/s(ea)?rch$/.test(l.id)&&v=="x"){d[0]=g.replace(/^x_/,"y_");ewr_UpdateOpt.apply(this,d)}}}function ewr_ClearOpt(e){var t=jQuery;if(e.options){var r=1;for(var a=e.length-1;a>=r;a--)if(!e.options[a].value.startsWith("@@"))e.options[a]=null}else if(e.length){var t=jQuery,n=ewr_GetId(e),i=ewr_GetElement("dsl_"+n,e[0].form);t(i).data("options",[]).find("div").first().empty();for(var a=0;a<e.length;a++){var o=e[a];var s=o.value;if(s.startsWith("@@")){var l=t(o).data("filter-name");if(l){var u=t(i).data("options");u[u.length]={val:s,lbl:l};t(i).data("options",u)}}}}else if(ewr_IsAutoSuggest(e)){var d=ewr_GetAutoSuggest(e);d._options=[];d.input.value="";e.value=""}else if(ewr_IsModalLookup(e)){t(e).data("options",[])}}function ewr_GetId(e,t){var r=jQuery,a="";if(r.isString(e)){a=e}else{a=r(e).attr("name")||r(e).attr("id")}if(t!==false&&/\[\]$/.test(a))a=a.substr(0,a.length-2);return a}function ewr_GetOptValues(e,t){var r=jQuery,a=r.isString(e)?ewr_GetElements(e,t):e;if(a.options){return r(a).find("option:selected[value!='']").map(function(){return this.value}).get()}else if(r.isNumber(a.length)){return r(a).filter(":checked[value!='{value}']").map(function(){return this.value}).get()}else{return[a.value]}}function ewr_GetElements(e,t){var r=jQuery,t=r.isString(t)?"#"+t:t,a="[name='"+e+"']";a="input"+a+",select"+a+",textarea"+a+",button"+a;var n=t?r(t).find(a):r(a);if(n.length==1&&n.is(":not(:checkbox):not(:radio)"))return n[0];return n.get()}function ewr_NewOpt(e,t,r){var a=jQuery,n=ewrForms[r.id],i=ewr_GetId(e),o=ewr_GetId(e,false),s,l=t[0],u={lf:t[0],df1:t[1],df2:t[2],df3:t[3],df4:t[4]};if(n.Lists(o).Template&&!ewr_IsAutoSuggest(e)){s=n.Lists(o).Template.render(u)}else{s=ewr_DisplayValue(t,e)||l}var d={data:u,name:i,form:r.$Element,value:l,text:s};if(e.options){a.extend(d,{option:a("<option/>").val(d.value).html(d.text)});a(document).trigger("newoption",[d]);a(e).append(d.option)}else if(e.length){var c=a(ewr_GetElement("dsl_"+i,r)),f=c.data("options");if(c[0]&&f)f[f.length]={val:d.value,lbl:d.text}}else if(ewr_IsAutoSuggest(e)){var p=ewr_GetAutoSuggest(e);p._options[p._options.length]={val:d.value,lbl:d.text}}else if(ewr_IsModalLookup(e)){var h=a(e),f=h.data("options")||[];f[f.length]={val:d.value,lbl:d.text};h.data("options",f)}return d.text}function ewr_RenderOpt(e){var t=jQuery,r=ewr_GetId(e),a=ewr_GetForm(e),n=t(e).parent().parent().find("#dsl_"+r);if(!n[0]||!n.data("options"))return;var i=n.parent().find("#tp_"+r);if(!i[0])return;var o=!EWR_IS_MOBILE?parseInt(n.data("repeatcolumn"),10)||5:1;var s=i.contents(),l=n.data("options"),u=s.attr("type");var d=n.prevAll(".dropdown-toggle"),c=n.prevAll(".ewDropdownListClear");if(l&&l.length){if(o>1||u=="checkbox"||!d[0]){var f=t('<table class="ewItemTable"></table>');if(u=="checkbox")f.click(function(e){e.stopPropagation()});for(var p=0,h=l.length;p<h;p++){if(p%o==0)$tr=t("<tr></tr>");var g=s.clone(true).val(l[p].val).click(function(e){if(d[0]){var r=f.find("input[name='"+this.name+"']:checked");var a=r.map(function(){return t(this).parent().text()}).get();var n=a.length>(t(this).data("maxcount")||3)?ewLanguage.Phrase("CountSelected").replace("%s",a.length):a.join(", ");d.html(a.length?n:ewLanguage.Phrase("PleaseSelect"));c.toggle(a.length>0)}});var m=t('<label class="'+u+'-inline"></label>').append(g.attr("id",g.attr("id")+"_"+p),l[p].lbl);var v={name:r,form:a,value:l[p].val,text:l[p].lbl,option:m};t(document).trigger("newoption",[v]);t("<td></td>").append(v.option).appendTo($tr);if(p%o==o-1){f.append($tr)}else if(p==h-1){for(var w=p%o+1;w<o;w++)$tr.append("<td></td>");f.append($tr)}}n.find("div").first().append(f)}else{var _=t('<div class="list-group"></div>');for(var p=0,h=l.length;p<h;p++){var g=s.clone(true).val(l[p].val).click(function(e){var r=t(this).closest(".list-group-item");if(r.hasClass("active"))this.checked=false;r.siblings(".list-group-item").removeClass("active");r.toggleClass("active",this.checked);d.html(this.checked?r.text():ewLanguage.Phrase("PleaseSelect"));c.toggle(this.checked)});var m=t('<label class="'+u+'-inline"></label>').append(g.attr("id",g.attr("id")+"_"+p),l[p].lbl);var E=t('<a class="list-group-item" href="#"></a>').append(m);var v={name:r,form:a,value:l[p].val,text:l[p].lbl,option:E};t(document).trigger("newoption",[v]);_.append(v.option)}n.find("div").first().append(_)}var b=t.trim(d.html());c.toggle(!!b&&b!=ewLanguage.Phrase("PleaseSelect")).off().click(function(e){n.find("[data-field]:radio,[data-field]:checkbox").prop("checked",false).first().triggerHandler("click");n.find(".list-group-item.active").removeClass("active");d.html(ewLanguage.Phrase("PleaseSelect"));c.hide()})}n.data("options",[])}function ewr_ValueSeparator(e,t){var r=jQuery,a=r(t).data("value-separator");return r.isArray(a)?a[e-1]:a||", "}function ewr_DisplayValue(e,t){var r=jQuery,a=e[1];for(var n=2;n<=4;n++){if(e[n]&&e[n]!=""){var i=ewr_ValueSeparator(n-1,t);if(r.isUndefined(i))break;if(a!="")a+=i;a+=e[n]}}return a}function ewr_SelectOpt(e,t){if(!e||!t||t.length==0)return;var r=jQuery,a=r(e);if(e.options){a.val(t);if(e.type=="select-one"&&e.selectedIndex==-1)e.selectedIndex=0}else if(e.length){if(e.length==1&&e[0].type=="checkbox"&&e[0].value!="{value}"){e[0].checked=ewr_ConvertToBool(e[0].value)===ewr_ConvertToBool(t[0])}else{a.val(t).closest(".ewDropdownList").find(".ewDropdownListClear").show();a.each(function(){r(this).closest(".list-group-item").toggleClass("active",this.checked)})}}else if(ewr_IsAutoSuggest(e)&&t.length==1){var n=ewr_GetAutoSuggest(e);for(var i=0,o=n._options.length;i<o;i++){if(n._options[i].val==t[0]){e.value=n._options[i].val;n.input.value=n._options[i].lbl;break}}}else if(ewr_IsModalLookup(e)){var a=r(e),s="",l="",u=a.data("options")||[];for(var d=0,c=t.length;d<c;d++){for(var i=0,o=u.length;i<o;i++){if(t[d]==u[i].val){s+=(s!==""?EWR_LOOKUP_FILTER_VALUE_SEPARATOR:"")+u[i].val;l+=(l!==""?", ":"")+u[i].lbl;break}}}a.val(s);a.parent().find(".ewLookupText").html(l!==""?l:ewLanguage.Phrase("PleaseSelect"))}else if(e.type){e.value=t.join(",")}function f(e){if(!r(e).data("autoselect"))return false;var t=ewr_GetForm(e);if(t){if(/s(ea)?rch$/.test(t.id))return false;var a=e.id.replace(/^([xy])(\d*)_/,"x_");if(a in ewrForms[t.id].Lists&&ewrForms[t.id].Lists[a].ParentFields.length==0)return false;return true}return false}if(e.options){if(e.type=="select-one"&&e.options.length==2&&!e.options[1].selected&&f(e)){e.options[1].selected=true}else if(e.type=="select-multiple"&&e.options.length==1&&!e.options[0].selected&&f(e)){e.options[0].selected=true}}else if(e.length){if(e.length==2&&f(e[1]))e[1].checked=true}else if(ewr_IsAutoSuggest(e)){var n=ewr_GetAutoSuggest(e);if(n._options.length==1&&f(e)){e.value=n._options[0].val;n.input.value=n._options[0].lbl}}}function ewr_AutoSuggest(e){var t,r,a=this,n=jQuery,i=e.id,o=e.form,s=e.forceSelect;var l=i.replace(/^[xy](\d*|\$rowindex\$)_/,"x_");var u=RegExp.$1;var d={typeahead:{}};if(u=="$rowindex$")return d;var c=o.GetElement();var f=o.GetElement("sx_"+i);if(!f)return d;var p=o.GetElement("sc_"+i);var h=o.Lists[l].ParentFields.slice();for(var g=0,m=h.length;g<m;g++){var v=h[g].split(" ");if(v.length==1)h[g]=h[g].replace(/^x_/,"x"+u+"_")}this.data=e.data;this.minWidth=e.minWidth;this.maxHeight=e.maxHeight;this.highlight=e.highlight;this.hint=e.hint;this.minLength=e.minLength;this.limit=e.limit;this.templates=n.extend({},e.templates);this.trigger=e.trigger;this.delay=e.delay;this.display=e.display||"value";this.input=f
;this.element=o.GetElement(i);this.$input=t=n(this.input);this.$element=r=n(this.element);this._options=[];this._recordCount=0;if(t.val()&&r.val())this._options.push({val:r.val(),lbl:t.val()});this.formatResult=function(e){return ewr_DisplayValue(e,this.element)||e[0]};this.setValue=function(e){e=e||t.val();var a=t.data("results")?n.map(t.data("results"),function(t,r){if(t["value"]==e)return r}):[];if(a.length==0){if(this._options&&this._options.length&&this._options[this._options.length-1].lbl==e)return;if(s&&e){t.typeahead("val","").attr("placeholder",ewLanguage.Phrase("ValueNotExist")).parent().append('<span class="glyphicon glyphicon-warning-sign form-control-feedback"></span>').addClass("has-error has-feedback");r.val("").change();return}}else{if(!/s(ea)?rch$/.test(c.id)||s){var i=a[0];if(i>-1)e=t.data("results")[i][0]}}if(e!==r.val())r.val(e).change()};this.generateRequest=function(){var e=this.data;if(h.length>0){for(var t=0,r=h.length;t<r;t++){var a=ewr_GetOptValues(h[t],c);e+="&v"+(t+1)+"="+encodeURIComponent(a.join(","))}}return"name="+this.element.name+"&"+e};this.prepare=function(e,t){var r={};r.data=this.generateRequest();r.type="POST";r.dataType="json";r.url=EWR_LOOKUP_FILE_NAME+"?q="+encodeURIComponent(e);r.url+="&n="+this.limit;if(n.isNumber(t))r.url+="&start="+t;r.url+="&rnd="+ewr_Random();return r};this.transform=function(e){var r;if(e&&e.Result=="OK"){a._recordCount=e.TotalRecordCount;r=e.Records}t.data("results",r||[]);var i=n.map(t.data("results"),function(e){var t=e["value"]=a.formatResult(e);return{lf:e[0],df1:e[1],df2:e[2],df3:e[3],df4:e[4],value:t}});return i};this.source=function(e,t,r){a._recordCount=0;var i=a.prepare(e);n.ajax(i).done(function(e){r(a.transform(e))})};this.count=function(){return a.typeahead.menu.$node.find(".tt-suggestion.tt-selectable").length};this.more=function(){n("body").css("cursor","wait");var e=a.typeahead,t=e.menu.query,r=e.menu.datasets[0];var i=a.count();var o=a.prepare(t,i);n.ajax(o).done(function(n){n=a.transform(n);r._append(t,n);e.menu.$node.find(".tt-dataset").scrollTop(r.$lastSuggestion.outerHeight()*i)}).always(function(){n("body").css("cursor","default")})};t.on("typeahead:select",function(e,t){a.setValue(t.value)}).blur(function(e){var r=t.data("tt-typeahead");if(r&&r.isOpen()&&!r.menu.empty()){var n=r.menu.getActiveSelectable();if(n){var i=n.index();var o=t.data("results")[i][1];t.typeahead("val",o)}}a.setValue()}).focus(function(e){t.attr("placeholder",t.data("placeholder")).closest(".has-error.has-feedback").removeClass("has-error has-feedback").find(".form-control-feedback").remove()});var w;if(o.Lists[l].Template){w=o.Lists[l].Template}else{w=a.templates["suggestion"]}if(w&&n.isString(w))w=n.templates(w);if(w)a.templates["suggestion"]=n.proxy(w.render,w);r.data("autosuggest",this);n(function(){var e={highlight:a.highlight,minLength:a.minLength,hint:a.hint,trigger:a.trigger,delay:a.delay};var s={name:o.ID+"-"+i,source:a.source,templates:a.templates,display:a.display,limit:a.limit,async:true};var l=[e,s];r.trigger("typeahead",[l]);a.limit=s.limit;t.typeahead.apply(t,l);t.on("typeahead:rendered",function(){var t=a.typeahead.menu.$node;var r=t.find(".tt-more").html(ewLanguage.Phrase("More"));if(arguments.length>1&&a._recordCount>a.count()){var i;r.one(e.trigger,function(t){if(i)i.cancel();n.later(e.delay,null,function(){a.more()});t.preventDefault();t.stopPropagation()})}else{r.hide()}});t.off("blur.tt");a.typeahead=t.data("tt-typeahead");var u=a.typeahead.menu.$node.css("z-index",9001);if(a.minWidth)u.css("min-width",a.minWidth);var d=u.find(".tt-dataset");var c=a.maxHeight||(parseInt(d.css("line-height"),10)+6)*(s.limit+1);d.css({"max-height":c,"overflow-y":"auto"})})}function ewr_GetElement(e,t){var r=jQuery,t=r.isString(t)?"#"+t:t,a="#"+e.replace(/([\$\[\]])/g,"\\$1")+",[name='"+e+"']";return t?r(t).find(a)[0]:r(a).first()[0]}function ewr_SameText(e,t){return String(e).toLowerCase()==String(t).toLowerCase()}function ewr_SameStr(e,t){return String(e)==String(t)}function ewr_InArray(e,t){return t.indexOf(e)}function ewr_Get(e,t){t=t||window.location.search;var r=/(?:\?|&)([^&=]+)=?([^&]*)/g;var a=/\+/g;var n=function(e){return decodeURIComponent(e.replace(a," "))};var i={},o;while(o=r.exec(t)){var s=n(o[1]),l=n(o[2]);if(s.substring(s.length-2)==="[]")s=s.substring(0,s.length-2);(i[s]||(i[s]=[])).push(l)}return i[e]}function ewr_SetLanguage(e){var t=jQuery,r=t(e),a=r.val()||r.data("language");if(!a)return;var n=window.location.href;if(window.location.search){var i=window.location.search;var o={};i.replace(/(?:\?|&)([^&=]*)=?([^&]*)/g,function(e,t,r){if(t)o[t]=r});o["language"]=encodeURIComponent(a);var s="?";for(var l in o)s+=l+"="+o[l]+"&";s=s.substr(0,s.length-1);var u=n.lastIndexOf(window.location.search);n=n.substr(0,u)+s}else{if(window.location.hash)n=n.split("#")[0]+"?language="+encodeURIComponent(a)+"#"+n.split("#")[1];else n+="?language="+encodeURIComponent(a)}window.location=n}function ewr_Sort(e,t,r){if(r==2&&e&&e.ctrlKey)t+="&ctrl=1";location=t;return true}function ewr_IsModalLookup(e){var t=jQuery,r=t(e);return e&&r.is(":hidden")&&r.data("lookup")}function ewr_IsAutoSuggest(e){var t=jQuery,r=t(e);return r[0]&&r.is(":hidden")&&r.data("autosuggest")}function ewr_GetAutoSuggest(e){return ewrForms(e).AutoSuggests[e.id]}function ewr_Alert(e,t,r){var a=jQuery;if(EWR_IS_MOBILE){alert(e);if(t)a.later(100,null,t)}else{var n=a("#ewrMsgBox");n.find(".modal-body").html('<p class="text-'+(r||"danger")+'">'+e+"</p>");n.find(".modal-footer button").prop("disabled",false);n.modal("show");if(t)n.off("hidden.bs.modal").on("hidden.bs.modal",t)}}function ewr_OnError(e,t,r){if(t.jquery){var a=t.attr("type");t=a=="checkbox"||a=="radio"?t.get():t[0]}ewr_Alert(r,function(){ewr_SetFocus(t)});return false}function ewr_SetFocus(e){if(!e)return;var t=jQuery,r=t(e);if(!e.options&&e.length){e=r.filter("[value!='{value}']")[0]}else if(ewr_IsAutoSuggest(e)){e=ewr_GetAutoSuggest(e).input}var a=r.closest(".form-group").addClass("has-error");if(ewr_IsModalLookup(e))a.find(":button").on("click",function(){a.removeClass("has-error")});else t(e).focus().select().one("click keypress",function(){a.removeClass("has-error")})}function ewr_HasValue(e){return ewr_GetOptValues(e).join("")!=""}function ewr_HtmlEncode(e){var t=e;t=t.replace(/&/g,"&amp");t=t.replace(/\"/g,"&quot;");t=t.replace(/</g,"&lt;");t=t.replace(/>/g,"&gt;");return t}function ewr_ClearForm(e){var t=jQuery;t(e).find("[id^=sv_],[id^=sv2_]").each(function(){if(this.type=="checkbox"||this.type=="radio"){this.checked=false}else if(this.type=="select-one"){this.selectedIndex=0}else if(this.type=="select-multiple"){t(this).find("option").prop("selected",false)}else if(this.type=="text"||this.type=="textarea"){this.value="";if(ewr_IsAutoSuggest(this))ewr_GetAutoSuggest(this).input.value=""}})}function ewr_StopPropagation(e){if(e.stopPropagation){e.stopPropagation()}else{e.cancelBubble=true}}function ewr_SetupTable(e,t,r){var a=jQuery,n=a(t),i=a(t.rows);if(!t||!t.rows||!r&&n.data("isset")||t.tBodies.length==0)return;var o=i.filter("[data-rowindex=1]").length||i.filter("[data-rowindex=0]").length||1;var s=i.filter(":not(."+EWR_ITEM_TEMPLATE_CLASSNAME+"):not(:hidden)").each(function(){a(this.cells).removeClass(EWR_TABLE_LAST_ROW_CLASSNAME).last().addClass(EWR_TABLE_LAST_COL_CLASSNAME)}).get();var l=n.parentsUntil(".ewGrid",".table-responsive")[0];if(s.length){for(var u=1;u<=o;u++){var d=s[s.length-u];a(d.cells).each(function(){if(this.rowSpan==u)a(this).addClass(EWR_TABLE_LAST_ROW_CLASSNAME).toggleClass(EWR_TABLE_BORDER_BOTTOM_CLASSNAME,!!l&&l.offsetHeight>t.offsetHeight)})}}ewr_SetupGrid(e,n.closest("."+EWR_GRID_CLASSNAME)[0],r);n.data("isset",true)}function ewr_SetupGrid(e,t,r){var a=jQuery,n=a(t);if(!t||!r&&n.data("isset"))return;n.find(".ewGridUpperPanel, .ewGridLowerPanel").each(function(){var e=a(this);if(!e.text().trim())e.hide()});var i=n.find("table."+EWR_TABLE_CLASSNAME+" > tbody:first > tr").length;if(i==0&&!n.find(".ewGridUpperPanel, .ewGridLowerPanel")[0])n.hide();if(!n.find(".ewGridUpperPanel:visible")[0])n.css({"border-top-left-radius":0,"border-top-right-radius":0});if(!n.find(".ewGridLowerPanel:visible")[0])n.css({"border-bottom-left-radius":0,"border-bottom-right-radius":0});if(n.width()>a(".content").width())a(document).trigger("overflow",[n]);n.data("isset",true)}function ewr_ModalGenerateUrlShow(e){var t=jQuery,r=ewrReportUrlDialog||t("#ewrReportUrlDialog"),a=t(".ewExtFilterForm");if(!r)return;var n=function(){o=[];if(a){var e=a.attr("id");var r=t.localStorage.get(e+"_filters")||[];var n=t.grep(r,function(e){if(t.isArray(e)&&e.length==2)return e});if(n.length){for(var i in n){if(!t.isArray(n[i]))continue;o[o.length]=n[i]}}}return o};var i=r.find(".modal-body form");i.find("#ewrReportType").off("change.ew").on("change.ew",function(){i.find(".ewReportEmail").toggleClass("hidden",t(this).val()!="email")}).triggerHandler("change");i.find("#ewrUrl").val("");var o=n();for(var s=0,l=o.length;s<l;s++)i.find("#ewrFilterName").find(".ewFilter").remove().end().append(t("<option>",{class:"ewFilter",value:o[s][0],text:o[s][0]}));var u=i.data("form");if(!u){u=new ewr_Form(i.attr("id"));u.Validate=function(){var e,t=this.GetForm();e=t.elements["sender"];if(e&&!ewr_HasValue(e))return this.OnError(e,ewLanguage.Phrase("EnterSenderEmail"));if(e&&!ewr_CheckEmailList(e.value,1))return this.OnError(e,ewLanguage.Phrase("EnterProperSenderEmail"));e=t.elements["recipient"];if(e&&!ewr_HasValue(e))return this.OnError(e,ewLanguage.Phrase("EnterRecipientEmail"));if(e&&!ewr_CheckEmailList(e.value,EWR_MAX_EMAIL_RECIPIENT))return this.OnError(e,ewLanguage.Phrase("EnterProperRecipientEmail"));e=t.elements["cc"];if(e&&!ewr_CheckEmailList(e.value,EWR_MAX_EMAIL_RECIPIENT))return this.OnError(e,ewLanguage.Phrase("EnterProperCcEmail"));e=t.elements["bcc"];if(e&&!ewr_CheckEmailList(e.value,EWR_MAX_EMAIL_RECIPIENT))return this.OnError(e,ewLanguage.Phrase("EnterProperBccEmail"));e=t.elements["subject"];if(e&&!ewr_HasValue(e))return this.OnError(e,ewLanguage.Phrase("EnterSubject"));return true};u.Submit=function(){var e=this.GetForm(),r=t(e);var n=ewr_GetOptValues("reporttype",e);var i=ewr_GetOptValues("filtername",e);if(n=="email"&&!this.Validate())return false;var s=r.serialize();if(i!=""){if(i=="@@current"){var l=a.attr("id")?ewrForms[a.attr("id")]:null;if(l&&l.FilterList)s+="&filter="+JSON.stringify(l.FilterList)}else{for(var u=0,d=o.length;u<d;u++){if(o[u][0]==i)s+="&filter="+JSON.stringify(o[u][1])}}}t.post(e.action,s,function(e){var a,n;if(e){try{a=t.parseJSON(e)}catch(e){}}if(t.isObject(a)&&a.url){n=a.url}else{n=ewr_StripScript(e).match(/<body[\s\S]*>[\s\S]*<\/body>/i)}r.find("#ewrUrl").val(n)});return false};i.data("form",u)}var d=t(e.currentTarget);r.modal("hide").find(".modal-title").html(d.data("original-title")||d.attr("title"));r.find(".modal-footer .btn-primary").unbind().click(function(e){e.preventDefault();u.Submit()});var c=r.find(".modal-footer .ewCopyToClipboard");if(!c.data("clipboard"))c.data("clipboard",new Clipboard(c[0]));ewrReportUrlDialog=r.modal("show")}function ewr_EmailDialogShow(e){var t=jQuery,r=ewrEmailDialog||t("#ewrEmailDialog");if(!r)return;var a=r.find(".modal-body form").data("args",e);var n=a.data("form");if(!n){n=new ewr_Form(a.attr("id"));n.Validate=function(){var e,t=this.GetForm();e=t.elements["sender"];if(e&&!ewr_HasValue(e))return this.OnError(e,ewLanguage.Phrase("EnterSenderEmail"));if(e&&!ewr_CheckEmailList(e.value,1))return this.OnError(e,ewLanguage.Phrase("EnterProperSenderEmail"));e=t.elements["recipient"];if(e&&!ewr_HasValue(e))return this.OnError(e,ewLanguage.Phrase("EnterRecipientEmail"));if(e&&!ewr_CheckEmailList(e.value,EWR_MAX_EMAIL_RECIPIENT))return this.OnError(e,ewLanguage.Phrase("EnterProperRecipientEmail"));e=t.elements["cc"];if(e&&!ewr_CheckEmailList(e.value,EWR_MAX_EMAIL_RECIPIENT))return this.OnError(e,ewLanguage.Phrase("EnterProperCcEmail"));e=t.elements["bcc"];if(e&&!ewr_CheckEmailList(e.value,EWR_MAX_EMAIL_RECIPIENT))return this.OnError(e,ewLanguage.Phrase("EnterProperBccEmail"));e=t.elements["subject"];if(e&&!ewr_HasValue(e))return this.OnError(e,ewLanguage.Phrase("EnterSubject"));return true};n.Submit=function(){var e=this.GetForm(),a=t(e),n=a.data("args");var i=ewr_GetOptValues("contenttype",e);if(n.url&&n.exportid&&i=="html"){if(!this.Validate())return false;r.modal("hide");ewr_ExportCharts(n.el,n.url,n.exportid,e)}else{var o=a.serialize();o+="&token="+EWR_TOKEN;t.post(e.action,o,function(e){ewr_ShowMessage(e)});r.modal("hide")}return false};a.data("form",n)}r.modal("hide").find(".modal-title").html(e.hdr);r.find(".modal-footer .btn-primary").unbind().click(function(e){e.preventDefault();if(n.Submit())r.modal("hide")});ewrEmailDialog=r.modal("show")}function ewr_ModalDialogHide(e){var t=jQuery,r=t(this);ewr_RemoveScript("ModalDialog");var a=r.removeData("args").find(".modal-body form").data("form");if(a)a.DestroyEditor();$body=r.find(".modal-body").html("");if($body.ewjtable&&$body.ewjtable("instance"))$body.ewjtable("destroy");r.find(".modal-footer .btn-primary").unbind();r.find(".modal-dialog").removeClass(function(e,t){var r=t.match(/table\-\w+/);return r?r[0]:""});r.data("showing",false)}function ewr_ModalLookupShow(e){var t=jQuery,r=e.el,a=ewr_GetForm(e.lnk);if(!a||!r)return;var n=ewrModalLookupDialog||t("#ewrModalLookupDialog").on("hidden.bs.modal",ewr_ModalDialogHide);if(n.data("showing"))return;n.data("showing",true);var i=ewr_GetId(r,true),o=t(a),s=o.find("[id='"+r+"']"),l=n.find(".modal-body");s.parent().find(".ewLookupText").focus();var u=function(e){if(e.Result=="OK"&&t.isArray(e.Records)){t.each(e.Records,function(t,r){var a={lf:r[0],df1:r[1],df2:r[2],df3:r[3],df4:r[4]};if(m.Template){a["df"]=m.Template.render(a)}else{a["df"]=ewr_DisplayValue(r,s)}e.Records[t]=a})}};var d=function(e,t){if(!ewr_IsAutoSuggest(s))return;var r=ewr_GetAutoSuggest(s[0]);r._options[r._options.length]={val:e,lbl:t};r.input.value=t};var c=function(r){var a=[],n="",i="",o=!e.m&&e.srch;l.ewjtable("selectedRows").each(function(){var e=t(this).data("record");var r=t.map(e,function(e){return e});a.push(e.lf);n+=(n!==""?", ":"")+e.df;i+=(i!==""?", ":"")+ewr_DisplayValue(r,s)});if(r.sort().join()===a.sort().join()){t(e.lnk).prev(".ewLookupList").find(".ewLookupText").html(n!=""?n:ewLanguage.Phrase("PleaseSelect"));d(a.join(),i);s.val(o?n:a.join()).change()}else{var c=_+"&"+t.param({keys:r});t.ajax(EWR_MODAL_LOOKUP_FILE_NAME,{type:"POST",dataType:"json",data:c}).done(u).then(function(r){if(r.Result=="OK"&&t.isArray(r.Records)){var a=[],n="",i="",l=r.Records;for(var u=0,c=l.length;u<c;u++){var f=l[u];var p=t.map(f,function(e){return e});a.push(f.lf);n+=(n!==""?", ":"")+f.df;i+=(i!==""?", ":"")+ewr_DisplayValue(p,s)}t(e.lnk).prev(".ewLookupList").find(".ewLookupText").html(n!=""?n:ewLanguage.Phrase("PleaseSelect"));d(a.join(),i);s.val(o?n:a.join()).change()}})}};var f=function(){c(w);n.modal("hide");return false};n.modal("hide");n.data("args",e);var p,h;var g=function(r){if(r.Result=="OK"){n.find(".modal-title").html(t(e.lnk).attr("title")||t(e.lnk).data("original-title"));n.find(".modal-footer").html('<button type="button" id="btnSelect" class="btn btn-primary ewButton">'+ewLanguage.Phrase("SelectBtn")+"</button>"+'<button type="button" class="btn btn-default ewButton" data-dismiss="modal">'+ewLanguage.Phrase("CancelBtn")+"</button>");h=t('<input type="text" name="sv" class="form-control" placeholder="'+ewLanguage.Phrase("Search")+'">').prependTo(l).on("keyup",function(e){if(p)p.cancel();p=t.later(EWR_LOOKUP_DELAY,null,function(){l.ewjtable("load",{sv:h.val()})})});n.find(".modal-footer #btnSelect").click(f);ewrModalLookupDialog=n.modal("show")}else{ewr_Alert(r.Message)}};var m=ewrForms[a.id].Lists(r.replace(/^[xy]\d*_/,"x_"));var v=s.val();var w=v!==""?v.split(","):[];var _=o.find("#s_"+i).val();_+="&lt="+encodeURIComponent(m.LinkTable);_+="&lf="+encodeURIComponent(m.LinkField.substring(2));for(var E=0,b=m.DisplayFields.length;E<b;E++)_+="&ldf"+(E+1)+"="+encodeURIComponent(m.DisplayFields[E].substring(2));var S=ewr_GetId(r,false);var y="",R="",T=S.match(/^([xy])(\d*)_/);if(T){y=T[1];R=T[2]}var x=S.replace(/^([xy])(\d*)_/,"x_");var A=m.ParentFields.slice();if(R!=""){for(var E=0,L=A.length;E<L;E++){var O=A[E].split(" ");if(O.length==1)A[E]=A[E].replace(/^x_/,"x"+R+"_")}}var D=[];for(var E=0,L=A.length;E<L;E++)D[D.length]=ewr_GetOptValues(A[E],a);for(var E=0,b=D.length;E<b;E++)_+="&v"+(E+1)+"="+encodeURIComponent(D[E].join(EWR_LOOKUP_FILTER_VALUE_SEPARATOR));t("body").css("cursor","wait");l.ewjtable({paging:true,pageSize:e.n,pageSizes:[],pageSizeChangeArea:false,paging:true,pageList:"minimal",selecting:true,selectingCheckboxes:true,multiselect:!!e.m,actions:{listAction:function(e,r){var a=_+"&start="+r.start+"&recperpage="+r.recperpage;if(t.isObject(e))a+="&"+t.param(e);return t.Deferred(function(e){t.ajax(EWR_MODAL_LOOKUP_FILE_NAME,{type:"POST",dataType:"json",data:a,success:function(t){e.resolve(t)},error:function(){e.reject()}})}).done(u).always(function(){t("body").css("cursor","default")})}},messages:{serverCommunicationError:ewLanguage.Phrase("ServerCommunicationError"),loadingMessage:ewLanguage.Phrase("Loading"),noDataAvailable:ewLanguage.Phrase("NoRecord"),close:ewLanguage.Phrase("CloseBtn"),pagingInfo:ewLanguage.Phrase("Record")+" {0}-{1} "+ewLanguage.Phrase("Of")+" {2}",pageSizeChangeLabel:ewLanguage.Phrase("RecordsPerPage"),gotoPageLabel:ewLanguage.Phrase("Page")},fields:{lf:{key:true,list:false},df:{}},recordsLoaded:function(e,r){var a=t(e.target).find(".ewjtable-data-row").filter(function(){return w.includes(String(t(this).data("record-key")))});t(e.target).ewjtable("selectRows",a)},selectionChanged:function(r,a){var n=a.rows;if(n){if(!e.m)w=[];n.each(function(){var e=t(this);var r=String(e.data("record-key"));var a=w.indexOf(r);var n=e.hasClass("ewjtable-row-selected");if(n&&a==-1)w.push(r);else if(!n&&a>-1)w.splice(a,1)})}}}).ewjtable("load",null,g)}function ewr_Ajax(e,t,r){if(!e)return undefined;var a=jQuery,n=a.extend({s:e},a.isObject(t)?t:{q:t});var i=function(e){if(a.isArray(e)&&e.length==1){e=e[0];if(a.isArray(e)&&e.length==1)return e[0];else return e}return e};if(a.isFunction(r)){a.post(EWR_LOOKUP_FILE_NAME,n,function(e){r(i(e))},"json")}else{var o=a.ajax({url:EWR_LOOKUP_FILE_NAME,async:false,type:"POST",data:n}).responseText;var s=a.parseJSON(o);return i(s)}}function ewr_ShowDrillDown(e,t,r,a,n){if(e&&e.ctrlKey){ewr_Redirect(r.replace("?d=1&","?d=2&"));return false}var i=jQuery,o=i.isString(t)?"top":"bottom",s=i.isString(t)?i("#"+t):i(t);s.tooltip("hide");var l={obj:s[0],id:a,url:r,hdr:n};i(document).trigger("drilldown",[l]);var u=l.url.split("?");l.file=u[0]?u[0]:"";l.data=u[1]?u[1]:"";l.data+=(l.data!=""?"&":"")+"token="+EWR_TOKEN;if(!s.data("bs.popover")){s.popover({html:true,placement:o,trigger:"manual",template:'<div class="popover"><h3 class="popover-title" style="cursor: move;"></h3>'+'<div class="popover-content"></div></div>',content:'<div class="ewrLoading"><div class="ewSpinner"><div></div></div> '+ewLanguage.Phrase("Loading").replace("%s","")+"</div>",container:i("#ewrDrillDownPanel")}).on("show.bs.popover",function(e){s.attr("data-original-title","")}).on("shown.bs.popover",function(e){if(!s.data("args"))return;i.ajax({cache:false,dataType:"html",type:"POST",data:s.data("args").data,url:s.data("args").file,success:function(e){var t=s.data("bs.popover").tip().on("mousedown",function(e){var t=i(this).addClass("drag");var r=t.outerHeight();var a=t.outerWidth();var n=t.offset().top+r-e.pageY;var o=t.offset().left+a-e.pageX;i(document.body).on("mousemove",function(e){var i=e.pageY+n-r;var s=e.pageX+o-a;if(t.hasClass("drag"))t.offset({top:i,left:s})}).on("mouseup",function(e){t.removeClass("drag")})});if(l.hdr)t.find(".popover-title").empty().show().append('<button type="button" class="close" aria-hidden="true">&times;</button>'+l.hdr).find(".close").click(function(){s.popover("hide")});var r=/<body[^>]*>([\s\S]*?)<\/body\s*>/i;if(e.match(r))e=RegExp.$1;var n=ewr_StripScript(e);var o=t.find(".popover-content").html(n);if(EWR_IS_MOBILE){var u=o.find("#ewContainer")[0];if(u)o.empty().append(u)}o.find(".ewTable").each(ewr_SetupTable);ewr_ExecScript(e,a)},error:function(e){if(e.responseText){var t=$el.data("bs.popover").tip();t.find(".popover-content").empty().append('<p class="text-error">'+e.responseText+"</p>")}}})}).on("hidden.bs.popover",function(e){for(var t=0;t<ewrDrillCharts.length;t++){var r=FusionCharts(ewrDrillCharts[t]);r.dispose()}ewrDrillCharts=[];ewr_RemoveScript(a)})}s.data("args",l).popover("show")}function ewr_ExecScript(e,t){var r,a=0,n=/<script([^>]*)>([\s\S]*?)<\/script\s*>/gi;while((r=n.exec(e))!=null){var i=RegExp.$2;if(i!=""&&!/ewr_Get(Css|Script)/i.test(i)&&/(\s+type\s*=\s*['"]*(text|application)\/(java|ecma)script['"]*)|^((?!\s+type\s*=).)*$/i.test(RegExp.$1))ewr_AddScript(i,"scr_"+t+"_"+a++)}}function ewr_StripScript(e){var t,r=/<script([^>]*)>([\s\S]*?)<\/script\s*>/gi;var a=e;while((t=r.exec(e))!=null){var n=RegExp.lastMatch;if(/(\s+type\s*=\s*['"]*(text|application)\/(java|ecma)script['"]*)|^((?!\s+type\s*=).)*$/i.test(RegExp.$1))a=a.replace(n,"")}return a}function ewr_AddScript(e,t){var r=document.createElement("SCRIPT");if(t)r.id=t;r.type="text/javascript";r.text=e;return document.body.appendChild(r)}function ewr_RemoveScript(e){if(e)jQuery("script[id^='scr_"+e+"_']").remove()}function ewr_Language(e){this.obj=e;this.Phrase=function(e){return this.obj[e.toLowerCase()]}}function ewr_ApplyTemplate(e,t,r,a,n){var i=jQuery,o=i("#"+t);if(!i.views||!o[0])return;i("span[data-class^=tp],div[data-class^=tp]").html(function(){var e=i(this);return"<scr"+'ipt type="text/html" class="'+r+'" id="'+e.data("class")+'">'+e.html()+"</scr"+"ipt>"});if(!o.attr("type"))o.attr("type","text/html");var s={data:n||{},id:e,template:t,enabled:true};i(document).trigger("rendertemplate",[s]);if(s.enabled)i("#"+e).html(o.render(s.data));if(a&&a!="print"){i(function(){var t=i("meta[http-equiv='Content-Type']");var n="<html><head>";if(t[0])n+="<meta http-equiv='Content-Type' content='"+t.attr("content")+"'>";if(a=="pdf"){n+="<link rel='stylesheet' type='text/css' href='"+EWR_PDF_STYLESHEET_FILENAME+"'>"}else{n+="<style>"+i.ajax({async:false,type:"GET",url:EWR_PROJECT_STYLESHEET_FILENAME}).responseText+"</style>"}n+="</"+"head><body>";i("span.ewChartTop").each(function(){n+=i(this).html()});n+=i("#"+e).find('div[id^="ct_"]').html();i("span.ewChartBottom").each(function(){n+=i(this).html()});n+="</body></html>";var o=window.location.href.split("?")[0];var s={customexport:a,data:n,filename:r};if(a=="email"){var l=window.location.search.replace(/^\?/,"")+"&"+i.param(s);l+="&token="+EWR_TOKEN;i.post(o,l,function(e){ewr_ShowMessage(e)})}else{ewr_FileDownload(o,s)}if(window.location!=window.parent.location&&window.parent.jQuery)window.parent.jQuery("body").css("cursor","default")})}}function ewr_RenderTemplate(e,t){var r=jQuery,a=e&&e.render?e:r(e);if(!a.render)return;var n={$template:a,data:t};r(document).trigger("rendertemplate",[n]);var i=a.render(n.data),o=n.$template.data("method"),s=n.$template.data("target");if(i&&o&&s)r(i)[o](s);else if(i&&!o&&s)r(s).html(i);else if(i&&!o&&!s)a.parent().append(i);return i}function ewr_RenderJsTemplates(e){var t=jQuery,r={},a=e&&e.target?e.target:document;t(a).find(".ewJsTemplate").each(function(e){var r=t(this),a=r.data("name"),n=r.data("data");if(n&&t.isString(n))n=ewrVar[n]||window[n];if(a){if(!t.render[a]){t.templates(a,r.text());ewr_RenderTemplate(r,n)}}else{ewr_RenderTemplate(r,n)}})}function ewr_ShowTemplates(e){var t=jQuery;t("script"+(e?"."+e:"")+"[type='text/html']").each(function(){$scr=t(this);if(/^\s*(<(td|th)[\s\S]*>[\s\S]*<\/\2>)\s*$/i.test($scr.html())){$scr.next().before(RegExp.$1)}else{t(this).after(t("<span></span>").addClass($scr.attr("class")).html($scr.html()))}$scr.closest(".ewTable, .ewViewTable").show();$scr.closest(".ewGrid").show()})}function ewr_ShowMessage(e){if(window.location!=window.parent.location&&parent.ewr_ShowMessage)return parent.ewr_ShowMessage(e);var t=jQuery,r=t("div.ewMessageDialog:first");var a=e||(r.length?EWR_IS_MOBILE?r.text():r.html():"");if(t.trim(a)=="")return;if(EWR_IS_MOBILE){alert(a)}else{var n=t("#ewrMsgBox");n.find(".modal-body").html(a);n.modal("show")}}function ewr_Random(){return Math.floor(Math.random()*100001)+1e5}function ewr_ToggleSrchOpr(e,t){var r=this.form.elements[e];if(!r)return;r.value=r.value!=t?t:"="}function ewr_ToggleGroup(e){var t=jQuery,r=t(e),a=r.closest("tr"),n="tr",i;for(var o=1;o<=6;o++){var s=o==1?"":"-"+o;var l=a.data("group"+s);if(t.isValue(l)){i=o;if(l!="")n+="[data-group"+s+"='"+String(l).replace(/'/g,"\\'")+"']"}}if(r.hasClass("icon-collapse")){t(n).slice(1).addClass("ewRptGrpHide"+i);r.toggleClass("icon-expand icon-collapse")}else{t(n).slice(1).removeClass("ewRptGrpHide"+i);r.toggleClass("icon-expand icon-collapse")}}function ewr_CheckUSDate(e){return ewr_CheckDateEx(e,"us",EWR_DATE_SEPARATOR)}function ewr_CheckShortUSDate(e){return ewr_CheckDateEx(e,"usshort",EWR_DATE_SEPARATOR)}function ewr_CheckDate(e){return ewr_CheckDateEx(e,"std",EWR_DATE_SEPARATOR)}function ewr_CheckShortDate(e){return ewr_CheckDateEx(e,"stdshort",EWR_DATE_SEPARATOR)}function ewr_CheckEuroDate(e){return ewr_CheckDateEx(e,"euro",EWR_DATE_SEPARATOR)}function ewr_CheckShortEuroDate(e){return ewr_CheckDateEx(e,"euroshort",EWR_DATE_SEPARATOR)}function ewr_CheckDateDef(e){if(EWR_DATE_FORMAT.match(/^yyyy/))return ewr_CheckDate(e);else if(EWR_DATE_FORMAT.match(/^yy/))return ewr_CheckShortDate(e);else if(EWR_DATE_FORMAT.match(/^m/)&&EWR_DATE_FORMAT.match(/yyyy$/))return ewr_CheckUSDate(e);else if(EWR_DATE_FORMAT.match(/^m/)&&EWR_DATE_FORMAT.match(/yy$/))return ewr_CheckShortUSDate(e);else if(EWR_DATE_FORMAT.match(/^d/)&&EWR_DATE_FORMAT.match(/yyyy$/))return ewr_CheckEuroDate(e);else if(EWR_DATE_FORMAT.match(/^d/)&&EWR_DATE_FORMAT.match(/yy$/))return ewr_CheckShortEuroDate(e);return false}function ewr_CheckDateEx(e,t,r){if(e==null||e.length==""||e.startsWith("@@"))return true;while(e.indexOf("  ")>-1)e=e.replace(/  /g," ");e=e.replace(/^\s*|\s*$/g,"");var a=e.split(" ");if(a.length>0){var n,i,o,s;n=/^([0-9]{4})-([0][1-9]|[1][0-2])-([0][1-9]|[1|2][0-9]|[3][0|1])$/;if(ar=n.exec(a[0])){i=ar[1];o=ar[2];s=ar[3]}else{var l="\\"+r;switch(t){case"std":n=new RegExp("^(\\d{4})"+l+"([0]?[1-9]|[1][0-2])"+l+"([0]?[1-9]|[1|2]\\d|[3][0|1])$");break;case"stdshort":n=new RegExp("^(\\d{2})"+l+"([0]?[1-9]|[1][0-2])"+l+"([0]?[1-9]|[1|2]\\d|[3][0|1])$");break;case"us":n=new RegExp("^([0]?[1-9]|[1][0-2])"+l+"([0]?[1-9]|[1|2]\\d|[3][0|1])"+l+"(\\d{4})$");break;case"usshort":n=new RegExp("^([0]?[1-9]|[1][0-2])"+l+"([0]?[1-9]|[1|2]\\d|[3][0|1])"+l+"(\\d{2})$");break;case"euro":n=new RegExp("^([0]?[1-9]|[1|2]\\d|[3][0|1])"+l+"([0]?[1-9]|[1][0-2])"+l+"(\\d{4})$");break;case"euroshort":n=new RegExp("^([0]?[1-9]|[1|2]\\d|[3][0|1])"+l+"([0]?[1-9]|[1][0-2])"+l+"(\\d{2})$");break}if(!n.test(a[0]))return false;var u=a[0].split(r);switch(t){case"std":case"stdshort":i=ewr_UnformatYear(u[0]);o=u[1];s=u[2];break;case"us":case"usshort":i=ewr_UnformatYear(u[2]);o=u[0];s=u[1];break;case"euro":case"euroshort":i=ewr_UnformatYear(u[2]);o=u[1];s=u[0];break}}if(!ewr_CheckDay(i,o,s))return false}if(a.length>1&&!ewr_CheckTime(a[1]))return false;return true}function ewr_UnformatYear(e){if(e.length==2)return e>EWR_UNFORMAT_YEAR?"19"+e:"20"+e;return e}function ewr_CheckDay(e,t,r){e=parseInt(e,10);t=parseInt(t,10);r=parseInt(r,10);var a=[4,6,9,11].includes(t)?30:31;if(t==2)a=e%4>0||e%100==0&&e%400>0?28:29;return ewr_CheckRange(r,1,a)}function ewr_CheckInteger(e){if(!e||e.length==0)return true;if(e.indexOf(EWR_DECIMAL_POINT)>-1)return false;return ewr_CheckNumber(e)}function ewr_CheckNumber(e){e=String(e);if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=new RegExp("^[+-]?(\\d{1,3}("+(EWR_THOUSANDS_SEP?"\\"+EWR_THOUSANDS_SEP+"?":"")+"\\d{3})*(\\"+EWR_DECIMAL_POINT+"\\d+)?|\\"+EWR_DECIMAL_POINT+"\\d+)$");return t.test(e)}function ewr_StrToFloat(e){e=String(e);if(EWR_THOUSANDS_SEP!=""){var t=new RegExp("\\"+EWR_THOUSANDS_SEP,"g");e=e.replace(t,"")}if(EWR_DECIMAL_POINT!="")e=e.replace(EWR_DECIMAL_POINT,".");return parseFloat(e)}function ewr_StrToDate(e){var t=/^(\d{4})-([0][1-9]|[1][0-2])-([0][1-9]|[1|2]\d|[3][0|1]) (?:(0\d|1\d|2[0-3]):([0-5]\d):([0-5]\d))?$/;var r=e.replace(t,"$1 $2 $3 $4 $5 $6").split(" ");return new Date(r[0],r[1]-1,r[2],r[3],r[4],r[5])}function ewr_CheckRange(e,t,r){if(!e||e.length==0)return true;var a=jQuery;if(a.isNumber(t)||a.isNumber(r)){if(ewr_CheckNumber(e))e=ewr_StrToFloat(e)}if(!a.isNull(t)&&e<t)return false;if(!a.isNull(r)&&e>r)return false;return true}function ewr_CheckTime(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=/^(0\d|1\d|2[0-3]):[0-5]\d:[0-5]\d$/;return t.test(e)}function ewr_CheckPhone(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=/^\(\d{3}\) ?\d{3}( |-)?\d{4}|^\d{3}( |-)?\d{3}( |-)?\d{4}$/;return t.test(e)}function ewr_CheckZip(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=/^\d{5}$|^\d{5}-\d{4}$/;return t.test(e)}function ewr_CheckCreditCard(e){if(!e||e.length==0)return true;var t=e.replace(/\D/g,"");if(t.length==0)return false;var r=t.length%2==1?false:true;var a,n=0;for(var i=0,o=t.length;i<o;i++){a=parseInt(t.charAt(i));if(r){a*=2;n+=a%10;if(a/10>=1)n++;r=false}else{n+=a;r=true}}return n%10==0}function ewr_CheckSSC(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=/^(?!000)([0-6]\d{2}|7([0-6]\d|7[012]))([ -]?)(?!00)\d\d\3(?!0000)\d{4}$/;return t.test(e)}function ewr_CheckEmailList(e,t){if(!e||e.length==0)return true;var r=e.replace(/,/g,";").split(";");for(var a=0,n=r.length;a<n;a++){if(t>0&&n>t)return false;if(!ewr_CheckEmail(r[a]))return false}return true}function ewr_CheckEmail(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=/^[\w.%+-]+@[\w.-]+\.[A-Z]{2,18}$/i;return t.test(e)}function ewr_CheckGUID(e){if(!e||e.length==0)return true;e=e.replace(/^\s*|\s*$/g,"");var t=/^\{\w{8}-\w{4}-\w{4}-\w{4}-\w{12}\}$/;var r=/^\w{8}-\w{4}-\w{4}-\w{4}-\w{12}$/;return t.test(e)||r.test(e)}function ewr_CheckByRegEx(e,t){if(!e||e.length==0)return true;return e.match(t)?true:false}function ewr_Redirect(e,t,r){if(!r||r.toLowerCase()=="post"){var a=jQuery,n={},i=t?a(t):a("<form></form>").appendTo("body");i.attr({action:e.split("?")[0],method:"post"});e+=(e.split("?").length>1?"&":"?")+"token="+EWR_TOKEN;e.replace(/(?:\?|&)([^&=]*)=?([^&]*)/g,function(e,t,r){if(t)a('<input type="hidden">').attr({name:t,value:r}).appendTo(i)});i.submit()}else{window.location=e}}function ewr_CreateDateTimePicker(e,t){var r=jQuery,a=r(t),n="",i=a.data("options")||[];var o=function(e,t){if(e==5||e==9)return t?9:5;else if(e==6||e==10)return t?10:6;else if(e==7||e==11)return t?11:7;else if(e==12||e==15)return t?15:12;else if(e==13||e==16)return t?16:13;else if(e==14||e==17)return t?17:14;return e};var s=a.data("formatid")||i.format||0;if(s==0)s=EWR_DATE_FORMAT_ID;else if(s==1)s=o(EWR_DATE_FORMAT_ID,true);else if(s==2)s=o(EWR_DATE_FORMAT_ID,false);switch(s){case 5:n="YYYY/MM/DD";break;case 6:n="MM/DD/YYYY";break;case 7:n="DD/MM/YYYY";break;case 9:n="YYYY/MM/DD HH:mm:ss";break;case 10:n="MM/DD/YYYY HH:mm:ss";break;case 11:n="DD/MM/YYYY HH:mm:ss";break;case 12:n="YY/MM/DD";break;case 13:n="MM/DD/YY";break;case 14:n="DD/MM/YY";break;case 15:n="YY/MM/DD HH:mm:ss";break;case 16:n="MM/DD/YY HH:mm:ss";break;case 17:n="DD/MM/YY HH:mm:ss";break}n=n.replace(/\//g,EWR_DATE_SEPARATOR).replace(/:/g,EWR_TIME_SEPARATOR);i.format=n;if(!i.locale)i.locale=EWR_LANGUAGE_ID.toLowerCase();var l=r.isBoolean(i.inputGroup)?i.inputGroup:true;delete i.inputGroup;var u={el:t,enabled:true,inputGroup:l,options:i};r(function(){r(document).trigger("datetimepicker",[u]);if(!u.enabled)return;if(u.inputGroup!==false){var e=r('<button type="button"><span class="glyphicon glyphicon-calendar"></span></button>').addClass("btn btn-default btn-sm datepickerbutton").css({"font-size":a.css("font-size"),height:a.outerHeight()
}).click(function(){r(this).closest(".has-error").removeClass("has-error")});a.wrap('<div class="input-group date"></div>').after(r('<span class="input-group-btn"></span>').append(e));a=a.parent()}if(u.options.locale&&moment.locale()!=u.options.locale){r.getScript(EWR_RELATIVE_PATH+"moment/locale/"+u.options.locale+".js",function(){a.datetimepicker(u.options)})}else{a.datetimepicker(u.options)}})}if(!jQuery.sub){jQuery.sub=function(){function e(t,r){return new e.fn.init(t,r)}jQuery.extend(true,e,this);e.superclass=this;e.fn=e.prototype=this();e.fn.constructor=e;e.sub=this.sub;e.fn.init=function r(a,n){var i=jQuery.fn.init.call(this,a,n,t);return i instanceof e?i:e(i)};e.fn.init.prototype=e.fn;var t=e(document);return e}}(function(){var e=jQuery.sub();e.fn.extend({row:function(){var e=this.closest(".ewRow");return e},visible:function(e){var t=this.closest(".ewCell");if(typeof e!="undefined"){t.toggle(e);return this}else{return t.is(":visible")}},readonly:function(e){if(typeof e!="undefined"){this.prop("readOnly",e);return this}else{return this.prop("readOnly")}},disabled:function(e){if(typeof e!="undefined"){this.prop("disabled",e);return this}else{return this.prop("disabled")}},value:function(e){var t=this.attr("type");if(typeof e!="undefined"){if(!jQuery.isArray(e))e=[e];var t=this.attr("type");var r=t=="radio"||t=="checkbox"?this.get():this[0];ewr_SelectOpt(r,e);return this}else{if(t=="checkbox"){return ewr_GetOptValues(this.get())}else if(t=="radio"){return ewr_GetOptValues(this.get()).join()}else{return this.val()}}},toNumber:function(){return ewr_ParseNumber(this.value())},toDate:function(){return ewr_ParseDate(this.value(),this.data("format"))},toJsDate:function(){return ewr_ParseDate(this.value(),this.data("format")).toDate()}});jQuery.fn.fields=function(t){var r=jQuery,a={},n=this.attr("id"),i=this[0],o,s;if(/^(sv|sv2)_/.test(n)){o=ewr_GetForm(i);s=this.data("table")}else if(i&&i.Form){o=i.$Element;s=i.ID.replace(new RegExp("^f|"+i.PageID+"$","g"),"")}var l="[data-table="+s+"][data-field"+(t?"=x_"+t:"")+"]";if(o&&l){r(o).find(l).each(function(){var t=this.getAttribute("data-field").substr(2),r=this.getAttribute("name");t=/^sv2_/.test(r)?"y_"+t:t;a[t]=a[t]?a[t].add(this):e(this)})}return t?a[t]:a}})();function ewr_ParseNumber(e,t){var r=jQuery;if(r.isString(e)){t=t||{thousandsSeparator:EWR_THOUSANDS_SEP,decimalSeparator:EWR_DECIMAL_POINT};var a=[],n,i=t.thousandsSeparator,o=t.decimalSeparator;if(i)a.push(i.replace(/[\-$\^*()+\[\]{}|\\,.?\s]/g,"\\$&")+"(?=\\d)");n=new RegExp("(?:"+a.join("|")+")","g");if(o===".")o=null;e=e.replace(n,"");e=o?e.replace(o,"."):e}if(r.isString(e)&&r.trim(e)!=="")e=+e;if(!r.isNumber||!isFinite(e))e=null;return e}function ewr_FormatNumber(e,t){var r=jQuery;if(r.isNumber(e)){t=t||{thousandsSeparator:EWR_THOUSANDS_SEP,decimalSeparator:EWR_DECIMAL_POINT};var a=e<0,n=e+"",i=t.decimalPlaces,o=t.decimalSeparator||".",s=t.thousandsSeparator,l,u,d,c;if(r.isNumber(i)&&i>=0&&i<=20)n=e.toFixed(i);if(o!==".")n=n.replace(".",o);if(s){l=n.lastIndexOf(o);l=l>-1?l:n.length;u=n.substring(l);for(d=0,c=l;c>0;c--){if(d%3===0&&c!==l&&(!a||c>1))u=s+u;u=n.charAt(c-1)+u;d++}n=u}return n}else{return r.isValue(e)&&e.toString?e.toString():""}}function ewr_ParseDate(e,t){var r=jQuery,a=r.makeArray(arguments);if(r.isNumber(t)&&t>=0&&t<=17){var n,i=EWR_DATE_FORMAT.toUpperCase(),o=EWR_DATE_SEPARATOR,s=EWR_TIME_SEPARATOR;switch(t){case 0:case 2:case 8:n=i+" HH"+s+"mm"+s+"ss";break;case 1:n="dddd, MMMM DD, YYYY";break;case 3:n="hh:mm:ss A";break;case 4:n="HH:mm:ss";break;case 5:n="YYYY"+o+"MM"+o+"DD";break;case 6:n="MM"+o+"DD"+o+"YYYY";break;case 7:n="DD"+o+"MM"+o+"YYYY";break;case 9:n="YYYY"+o+"MM"+o+"DD HH"+s+"mm"+s+"ss";break;case 10:n="MM"+o+"DD"+o+"YYYY HH"+s+"mm"+s+"ss";break;case 11:n="DD"+o+"MM"+o+"YYYY HH"+s+"mm"+s+"ss";break;case 12:n="YY"+o+"MM"+o+"DD";break;case 13:n="MM"+o+"DD"+o+"YY";break;case 14:n="DD"+o+"MM"+o+"YY";break;case 15:n="YY"+o+"MM"+o+"DD HH"+s+"mm"+s+"ss";break;case 16:n="MM"+o+"DD"+o+"YY HH"+s+"mm"+s+"ss";break;case 17:n="DD"+o+"MM"+o+"YY HH"+s+"mm"+s+"ss";break}a[1]=[n,"YYYY-MM-DD HH"+s+"mm"+s+"ss"]}return moment.apply(this,a)}function ewr_FormatDate(e,t){return moment(e).format(t||EWR_DATE_FORMAT.toUpperCase())}if(!String.prototype.includes){String.prototype.includes=function(e,t){"use strict";if(typeof t!=="number"){t=0}if(t+e.length>this.length){return false}else{return this.indexOf(e,t)!==-1}}}if(!String.prototype.startsWith){String.prototype.startsWith=function(e,t){return this.substr(t||0,e.length)===e}}if(!String.prototype.endsWith){String.prototype.endsWith=function(e,t){if(!(t<this.length))t=this.length;else t|=0;return this.substr(t-e.length,e.length)===e}}if(!Array.prototype.includes){Object.defineProperty(Array.prototype,"includes",{value:function(e,t){if(this==null){throw new TypeError('"this" is null or not defined')}var r=Object(this);var a=r.length>>>0;if(a===0){return false}var n=t|0;var i=Math.max(n>=0?n:a-Math.abs(n),0);function o(e,t){return e===t||typeof e==="number"&&typeof t==="number"&&isNaN(e)&&isNaN(t)}while(i<a){if(o(r[i],e)){return true}i++}return false}})}if(!Array.prototype.indexOf){Array.prototype.indexOf=function(e,t){var r;if(this==null){throw new TypeError('"this" is null or not defined')}var a=Object(this);var n=a.length>>>0;if(n===0){return-1}var i=t|0;if(i>=n){return-1}r=Math.max(i>=0?i:n-Math.abs(i),0);while(r<n){if(r in a&&a[r]===e){return r}r++}return-1}}jQuery.extend({isBoolean:function(e){return typeof e==="boolean"},isNull:function(e){return e===null},isNumber:function(e){return typeof e==="number"&&isFinite(e)},isObject:function(e){return e&&(typeof e==="object"||this.isFunction(e))||false},isString:function(e){return typeof e==="string"},isUndefined:function(e){return typeof e==="undefined"},isValue:function(e){return this.isObject(e)||this.isString(e)||this.isNumber(e)||this.isBoolean(e)},isDate:function(e){return this.type(e)==="date"&&e.toString()!=="Invalid Date"&&!isNaN(e)},later:function(e,t,r,a,n){e=e||0;t=t||{};var i=r,o=a,s,l;if(this.isString(r))i=t[r];if(!i)return;if(!this.isUndefined(a)&&!this.isArray(o))o=[a];s=function(){i.apply(t,o||[])};l=n?setInterval(s,e):setTimeout(s,e);return{interval:n,cancel:function(){if(this.interval){clearInterval(l)}else{clearTimeout(l)}}}}});+function(e){"use strict";var t=".dropdown-backdrop";var r=".ewDropdown";var a=function(t){e(t).on("click.bs.dropdown",this.toggle)};a.VERSION="3.3.7";function n(t){var r=t.attr("data-target");if(!r){r=t.attr("href");r=r&&/#[A-Za-z]/.test(r)&&r.replace(/.*(?=#[^\s]*$)/,"")}var a=r&&e(r);return a&&a.length?a:t.parent()}function i(a){if(a&&a.which===3)return;e(t).remove();e(r,e(a.currentTarget).is(r)?e(a.currentTarget).parent():document).each(function(){var t=e(this);var r=n(t);var i={relatedTarget:this};if(!r.hasClass("open"))return;if(a&&a.type=="click"&&/input|textarea/i.test(a.target.tagName)&&e.contains(r[0],a.target))return;r.trigger(a=e.Event("hide.bs.dropdown",i));if(a.isDefaultPrevented())return;t.attr("aria-expanded","false");r.removeClass("open").trigger(e.Event("hidden.bs.dropdown",i))})}a.prototype.toggle=function(t){var r=e(this);if(r.is(".disabled, :disabled"))return;var a=n(r);var o=a.hasClass("open");var s=t.target.nodeName;i(t);if(!o){if("ontouchstart"in document.documentElement&&!a.closest(".navbar-nav").length){e(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(e(this)).on("click",i)}var l={relatedTarget:this};a.trigger(t=e.Event("show.bs.dropdown",l));if(t.isDefaultPrevented())return;r.trigger("focus").attr("aria-expanded","true");a.toggleClass("open").trigger(e.Event("shown.bs.dropdown",l))}var u=r.attr("href");if(u&&u!="#"&&window.matchMedia){if(EWR_IS_SCREEN_SM_MIN){return true}else{return s=="SPAN"}}return false};a.prototype.keydown=function(t){if(!/(38|40|27|32)/.test(t.which)||/input|textarea/i.test(t.target.tagName))return;var a=e(this);t.preventDefault();t.stopPropagation();if(a.is(".disabled, :disabled"))return;var i=n(a);var o=i.hasClass("open");if(!o&&t.which!=27||o&&t.which==27){if(t.which==27)i.find(r).trigger("focus");return a.trigger("click")}var s=" li:not(.disabled):visible a";var l=i.find(".dropdown-menu"+s);if(!l.length)return;var u=l.index(t.target);if(t.which==38&&u>0)u--;if(t.which==40&&u<l.length-1)u++;if(!~u)u=0;l.eq(u).trigger("focus")};function o(t){return this.each(function(){var r=e(this);var n=r.data("bs.dropdown");if(!n)r.data("bs.dropdown",n=new a(this));if(typeof t=="string")n[t].call(r)})}var s=e.fn.dropdown;e.fn.dropdown=o;e.fn.dropdown.Constructor=a;e.fn.dropdown.noConflict=function(){e.fn.dropdown=s;return this};e(document).on("click.bs.dropdown.data-api",i).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",r,a.prototype.toggle).on("keydown.bs.dropdown.data-api",r,a.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",a.prototype.keydown)}(jQuery);